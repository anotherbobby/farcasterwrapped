ğŸ‰ FARCASTER 2025 WRAPPED â€” COMPLETE BLUEPRINT v3.0
================================================================================

                    SPOTIFY-STYLE â€¢ MINIMALIST â€¢ PRODUCTION-READY

================================================================================
                              TABLE OF CONTENTS
================================================================================

 1. Executive Summary
 2. Core Concept & User Journey
 3. Technical Architecture
 4. Smart Contract Specification
 5. Data Structure & Gas Optimization
 6. Rarity System & Calculation
 7. Stats Verification & Security
 8. NFT Metadata & SVG Generation (Minimalist Design)
 9. Royalty System (ERC2981)
10. Minting Rules & Eligibility
11. Leaderboard System
12. Frame Integration (Farcaster)
13. Economic Model & Sustainability
14. Deployment Guide
15. Testing Strategy
16. Edge Cases & Error Handling
17. Roadmap & Future Features
18. Appendix & Resources


================================================================================
1ï¸âƒ£ EXECUTIVE SUMMARY
================================================================================

PROJECT: Farcaster 2025 Wrapped
TAGLINE: Your year on Farcaster, wrapped up in an NFT

WHAT IT IS:
A Spotify Wrapped-inspired NFT that captures your entire Farcaster year in a 
minimalist, typography-focused design. No pixel art or external images needed - 
pure gradients, stats, and your social journey.

KEY FEATURES:
âœ… 1 mint per user per calendar year
âœ… 10 comprehensive stats (casts, likes, replies, engagement, consistency, etc.)
âœ… 5 rarity tiers with dynamic gradient designs (Common â†’ Legendary)
âœ… Fully on-chain SVG (pure typography, no external images)
âœ… 3% perpetual royalties to original minter
âœ… Integrated Farcaster Frame with Wrapped-style presentation
âœ… Gas-optimized for Base L2 (~$0.60 per mint)
âœ… Personality type based on behavior patterns

DESIGN PHILOSOPHY:
ğŸ¨ Minimalist & Typography-Focused (like Spotify Wrapped)
ğŸ¨ No external images or pixel art needed
ğŸ¨ Dynamic gradients based on rarity tier
ğŸ¨ Stats are the hero, not graphics
ğŸ¨ Black background, bold text, vibrant colors

TARGET USERS:
- Active Farcaster users wanting to showcase their year
- Social proof seekers wanting on-chain proof of engagement
- NFT collectors seeking minimalist, utility-focused art
- Community builders wanting to celebrate their impact

TECHNICAL STACK:
- Blockchain: Base L2 (Ethereum)
- Smart Contract: Solidity 0.8.20 (Solady optimized)
- Backend: Node.js + Express
- Stats Provider: Neynar API
- Cache: Redis (leaderboard)
- Frontend: Farcaster Frame (Frog framework)


================================================================================
2ï¸âƒ£ CORE CONCEPT & USER JOURNEY
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CONCEPT OVERVIEW                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Farcaster 2025 Wrapped adalah pengalaman interaktif yang merayakan â”‚
â”‚ perjalanan sosial user selama 2025 dalam format Wrapped Story.     â”‚
â”‚                                                                     â”‚
â”‚ Wrapped mencakup:                                                   â”‚
â”‚ â€¢ 11 slide presentasi (seperti Spotify Wrapped)                    â”‚
â”‚ â€¢ 10 stats komprehensif (casts, time spent, patterns, dll)         â”‚
â”‚ â€¢ Personality type (Community Builder, Influencer, dll)            â”‚
â”‚ â€¢ Rarity tier berdasarkan engagement                               â”‚
â”‚ â€¢ Mintable NFT card dengan desain minimalis                        â”‚
â”‚ â€¢ Shareable ke Farcaster dengan auto-generated cast                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER JOURNEY:

Step 1: Discovery
â”œâ”€ User sees "Get Your 2025 Wrapped!" frame in feed
â”œâ”€ Click to open interactive Wrapped experience
â””â”€ Frame intro: "Wrapped â€¢ Farcaster 2025"

Step 2: Wrapped Story (11 Slides)
â”œâ”€ Slide 1: Intro with username
â”œâ”€ Slide 2: Top stats (casts, likes, engagement)
â”œâ”€ Slide 3: Impact score (content + reach + engagement)
â”œâ”€ Slide 4: Engagement explosion (likes, recasts, replies)
â”œâ”€ Slide 5: Community impact (followers, connections)
â”œâ”€ Slide 6: Activity pattern (best day, peak hour)
â”œâ”€ Slide 7: Consistency score (months active)
â”œâ”€ Slide 8: Personality type reveal
â”œâ”€ Slide 9: Rarity tier reveal
â”œâ”€ Slide 10: Achievement unlocked
â””â”€ Slide 11: NFT card preview + mint CTA

Step 3: NFT Preview
â”œâ”€ See minimalist card design
â”œâ”€ Black background with gradient accents
â”œâ”€ Typography-focused (no images)
â”œâ”€ Stats grid layout
â””â”€ Rarity tier badge with dynamic color

Step 4: Mint Decision
â”œâ”€ User click "Mint NFT (0.0005 ETH)"
â”œâ”€ See preview of their unique card
â”œâ”€ Total cost: ~$2.10 (fee + gas)
â””â”€ User confirm transaction

Step 5: Minting
â”œâ”€ Backend verifies stats + generates signature
â”œâ”€ Transaction submitted to Base chain
â”œâ”€ Contract mints NFT with minimalist SVG
â””â”€ ~15 seconds later â†’ success!

Step 6: Share & Celebrate
â”œâ”€ See final NFT card
â”œâ”€ Auto-generated share text for Farcaster
â”œâ”€ Share your Wrapped journey
â”œâ”€ Card auto-listed on OpenSea
â””â”€ Future sales â†’ 3% royalty to minter

WRAPPED STORY THEMES:

Theme 1: "Your Top Stats"
â”œâ”€ Focus: Raw numbers
â”œâ”€ Visual: Large bold numbers, gradient text
â””â”€ Message: "You were active!"

Theme 2: "Impact Score"
â”œâ”€ Focus: Overall contribution
â”œâ”€ Visual: Large activity score number
â””â”€ Message: "You made X impact points!"

Theme 3: "Community Builder"
â”œâ”€ Focus: Connections made
â”œâ”€ Visual: Network visualization with numbers
â””â”€ Message: "You connected with X people"

Theme 4: "Consistency King"
â”œâ”€ Focus: Regular activity
â”œâ”€ Visual: Monthly bar chart
â””â”€ Message: "You showed up X/12 months"

Theme 5: "Your Personality"
â”œâ”€ Focus: Behavior-based type
â”œâ”€ Visual: Gradient card with traits
â””â”€ Message: "You are a [Personality Type]"


================================================================================
3ï¸âƒ£ TECHNICAL ARCHITECTURE
================================================================================

SYSTEM DIAGRAM:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       USER (Farcaster App)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Wrapped Frame    â”‚
                    â”‚ (11-Slide Story) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚              â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Backend API    â”‚    â”‚    â”‚  Base Blockchain â”‚
    â”‚  (Stats + Sign)  â”‚    â”‚    â”‚  (Smart Contract)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚             â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”‚
    â”‚   Neynar API     â”‚    â”‚              â”‚
    â”‚ (Farcaster Stats)â”‚    â”‚              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚              â”‚
                            â”‚              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      Redis       â”‚    â”‚    â”‚   OpenSea API    â”‚
    â”‚  (Leaderboard)   â”‚    â”‚    â”‚  (NFT Indexer)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  User's Wallet â”‚
                    â”‚ (MetaMask, CB) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DATA FLOW (Wrapped Experience):

[1] User opens Wrapped Frame
      â†“
[2] Frame â†’ Backend: GET /api/wrapped/:fid
      â†“
[3] Backend â†’ Neynar: Fetch full year stats
      â†“
[4] Backend calculates:
    - Time spent estimate
    - Activity patterns (best day, peak hour)
    - Personality type
    - Rarity tier
      â†“
[5] Backend â†’ Frame: Return wrapped data + signature
      â†“
[6] Frame displays 11-slide story (user navigates)
      â†“
[7] User reaches NFT slide â†’ sees card preview
      â†“
[8] User clicks "Mint NFT"
      â†“
[9] Frame â†’ Contract: mint() with signature
      â†“
[10] Contract:
     - Verifies signature
     - Calculates rarity
     - Generates minimalist SVG
     - Mints NFT
      â†“
[11] Success â†’ show card + share buttons
      â†“
[12] User shares to Farcaster with auto-generated text


================================================================================
4ï¸âƒ£ SMART CONTRACT SPECIFICATION
================================================================================

CONTRACT: FarcasterWrapped2025.sol
VERSION: 3.0.0
LICENSE: MIT

INHERITANCE TREE:
FarcasterWrapped2025
â”œâ”€ ERC721 (from Solady - gas optimized)
â”œâ”€ Ownable (from OpenZeppelin)
â””â”€ IERC2981 (royalty interface)

CONSTANTS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Name             â”‚ Type             â”‚ Value                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MINT_FEE         â”‚ uint256 constant â”‚ 0.0005 ether           â”‚
â”‚ ROYALTY_BPS      â”‚ uint16 constant  â”‚ 300 (3%)               â”‚
â”‚ YEAR             â”‚ uint16 constant  â”‚ 2025                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STATE VARIABLES:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Variable          â”‚ Type                      â”‚ Storage Cost         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ _wrapped          â”‚ mapping(uint256=>WrappedData)â”‚ 2 slots per token â”‚
â”‚ _hasMinted        â”‚ mapping(uint32=>bool)     â”‚ 1 slot per FID       â”‚
â”‚ _nextTokenId      â”‚ uint256                   â”‚ 1 slot (shared)      â”‚
â”‚ statsOracle       â”‚ address immutable         â”‚ 0 (in bytecode)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STRUCT: WrappedData (Ultra-Optimized - 2 Storage Slots)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SLOT 1 (256 bits)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ uint32  fid              â”‚ 32 bits  â”‚ Farcaster ID            â”‚
â”‚ uint16  casts            â”‚ 16 bits  â”‚ Total casts (max 65k)   â”‚
â”‚ uint16  likes            â”‚ 16 bits  â”‚ Likes received          â”‚
â”‚ uint16  replies          â”‚ 16 bits  â”‚ Reply count             â”‚
â”‚ uint16  recasts          â”‚ 16 bits  â”‚ Recast count            â”‚
â”‚ uint16  followers        â”‚ 16 bits  â”‚ Followers gained        â”‚
â”‚ uint8   consistency      â”‚ 8 bits   â”‚ Active months (0-12)    â”‚
â”‚ uint8   rarityTier       â”‚ 8 bits   â”‚ Tier (0-4)              â”‚
â”‚ uint8   activityScore    â”‚ 8 bits   â”‚ Score / 100 (0-255)     â”‚
â”‚ uint32  mintTimestamp    â”‚ 32 bits  â”‚ Unix timestamp          â”‚
â”‚ uint32  uniqueInteractorsâ”‚ 32 bits  â”‚ Unique users engaged    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         SLOT 2 (256 bits)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ address minter           â”‚ 160 bits â”‚ Original minter         â”‚
â”‚ bytes12 usernameHash     â”‚ 96 bits  â”‚ Short username ref      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MAIN FUNCTIONS:

function mint(
    uint32 fid,
    string calldata username,
    uint16 casts,
    uint16 likes,
    uint16 replies,
    uint16 recasts,
    uint16 followers,
    uint8 consistency,
    uint32 uniqueInteractors,
    uint8 engagementRate,
    uint8 activityScore,
    bytes calldata signature
) external payable returns (uint256 tokenId)

Description:
- Mints Wrapped 2025 NFT
- Verifies signature from backend
- Calculates rarity tier
- Generates minimalist SVG (Spotify style)
- Stores packed data

Checks:
- require(msg.value == MINT_FEE)
- require(!_hasMinted[fid])
- require(consistency <= 12)
- require(verifySignature(hash, signature))

Gas: ~150,000


function tokenURI(uint256 tokenId)
    public view override returns (string memory)

Description:
- Generates metadata + minimalist SVG
- Pure typography design (no images)
- Dynamic gradients based on rarity
- Returns data URI format

SVG Style:
- Black background (#000000)
- Gradient based on rarity tier
- Bold typography (no serifs)
- Stats grid layout
- Clean, modern design

Gas: ~80,000 (view only)


function getWrappedData(uint256 tokenId)
    external view returns (WrappedData memory)

Description:
- Returns full unpacked data
- For external apps/analytics

Gas: ~3,000 (view only)


================================================================================
5ï¸âƒ£ DATA STRUCTURE & GAS OPTIMIZATION
================================================================================

OPTIMIZATION STRATEGY:

Same as original blueprint - achieve ~150k gas per mint through:
âœ… Storage packing (2 slots)
âœ… On-demand SVG generation
âœ… Solady ERC721
âœ… Minimal events
âœ… Immutable variables

NEW: Minimalist SVG saves additional ~10k gas
- No complex pixel art rendering
- Pure text + gradients
- Simpler SVG structure
- ~60% smaller file size

Total Gas: ~140-150k (slightly better than original)


================================================================================
6ï¸âƒ£ RARITY SYSTEM & CALCULATION
================================================================================

ACTIVITY SCORE CALCULATION:

Purpose: Measure overall contribution without claiming "time spent"
Formula: Weighted points based on different activity types

ActivityScore = 
  (Casts Ã— 10) +                    // Creating content
  (Replies Ã— 15) +                  // Meaningful conversations
  (Likes Ã— 1) +                     // Engagement signals
  (Recasts Ã— 5) +                   // Amplifying others
  (Followers Ã— 2) +                 // Growing audience
  (UniqueInteractors Ã— 3)           // Network breadth

Capped at 10,000 points (displayed as 0-100 scale)

Example Calculations:

User A (High Activity):
â”œâ”€ Casts: 800 â†’ 8,000 pts
â”œâ”€ Replies: 400 â†’ 6,000 pts
â”œâ”€ Likes: 2,000 â†’ 2,000 pts
â”œâ”€ Recasts: 500 â†’ 2,500 pts
â”œâ”€ Followers: 150 â†’ 300 pts
â”œâ”€ Unique: 250 â†’ 750 pts
â””â”€ Total: 19,550 pts â†’ 100/100 (capped)

User B (Moderate Activity):
â”œâ”€ Casts: 300 â†’ 3,000 pts
â”œâ”€ Replies: 150 â†’ 2,250 pts
â”œâ”€ Likes: 800 â†’ 800 pts
â”œâ”€ Recasts: 200 â†’ 1,000 pts
â”œâ”€ Followers: 50 â†’ 100 pts
â”œâ”€ Unique: 100 â†’ 300 pts
â””â”€ Total: 7,450 pts â†’ 74/100

User C (Casual):
â”œâ”€ Casts: 50 â†’ 500 pts
â”œâ”€ Replies: 30 â†’ 450 pts
â”œâ”€ Likes: 200 â†’ 200 pts
â”œâ”€ Recasts: 40 â†’ 200 pts
â”œâ”€ Followers: 10 â†’ 20 pts
â”œâ”€ Unique: 25 â†’ 75 pts
â””â”€ Total: 1,445 pts â†’ 14/100

WHY THIS IS BETTER THAN "TIME SPENT":

âœ… Honest: No false claims about actual time
âœ… Measurable: Based on verifiable on-chain data
âœ… Comparable: Fair across different usage patterns
âœ… Motivating: Shows tangible contribution
âœ… Accurate: No need to estimate unknowable metrics

Implementation (Solidity):

function _calculateActivityScore(
    uint16 casts,
    uint16 likes,
    uint16 replies,
    uint16 recasts,
    uint16 followers,
    uint32 uniqueInteractors
) internal pure returns (uint8) {
    uint256 score = 
        (uint256(casts) * 10) +
        (uint256(replies) * 15) +
        (uint256(likes) * 1) +
        (uint256(recasts) * 5) +
        (uint256(followers) * 2) +
        (uint256(uniqueInteractors) * 3);
    
    // Convert to 0-100 scale (cap at 10,000)
    if (score > 10000) score = 10000;
    return uint8(score / 100);
}

RARITY FORMULA (Unchanged):

RarityScore = 
  (Casts / 1000) Ã— 10 +              // Max 10 pts
  (Likes / 5000) Ã— 20 +               // Max 20 pts
  (Replies / 500) Ã— 12 +              // Max 12 pts
  (Recasts / 500) Ã— 12 +              // Max 12 pts
  (Followers / 200) Ã— 8 +             // Max 8 pts
  (Consistency / 12) Ã— 20 +           // Max 20 pts (highest weight)
  (UniqueInteractors / 300) Ã— 18      // Max 18 pts

Total: 100 points maximum

TIER MAPPING:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tier       â”‚ Score  â”‚ Color   â”‚ %    â”‚ Personality            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Legendary  â”‚ 85-100 â”‚ #FFD700 â”‚  ~5% â”‚ Elite Community Leader â”‚
â”‚ Epic       â”‚ 70-84  â”‚ #9B59B6 â”‚ ~10% â”‚ Power User             â”‚
â”‚ Rare       â”‚ 50-69  â”‚ #3498DB â”‚ ~20% â”‚ Active Contributor     â”‚
â”‚ Uncommon   â”‚ 30-49  â”‚ #2ECC71 â”‚ ~30% â”‚ Regular Member         â”‚
â”‚ Common     â”‚  0-29  â”‚ #95A5A6 â”‚ ~35% â”‚ Casual Explorer        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PERSONALITY TYPES (Based on behavior):

Community Builder:
â”œâ”€ High unique interactors (>250)
â”œâ”€ Balanced casts/replies ratio
â””â”€ Strong consistency (10+/12)

Content Creator:
â”œâ”€ High casts (>800)
â”œâ”€ High likes per cast (>10)
â””â”€ Moderate consistency (7+/12)

Conversation Starter:
â”œâ”€ High replies (>400)
â”œâ”€ High engagement rate (>18%)
â””â”€ Active discussions

Curator/Amplifier:
â”œâ”€ High recasts (>500)
â”œâ”€ Moderate own content
â””â”€ Supports community

Casual Explorer:
â”œâ”€ Low overall stats
â”œâ”€ Inconsistent activity
â””â”€ Still part of community


================================================================================
7ï¸âƒ£ STATS VERIFICATION & SECURITY
================================================================================

(Same as original blueprint)

SECURITY MODEL:
âœ… Backend signature verification (trusted oracle)
âœ… Timestamp-bound signatures (10 min expiry)
âœ… On-chain FID verification
âœ… Rate limiting on backend
âœ… One mint per FID enforcement


================================================================================
8ï¸âƒ£ NFT METADATA & SVG GENERATION (MINIMALIST DESIGN)
================================================================================

METADATA STRUCTURE:

{
  "name": "Farcaster Wrapped 2025 #42",
  "description": "Your 2025 journey on Farcaster, wrapped up in stats and style.",
  "image": "data:image/svg+xml;base64,PHN2ZyB4bWxu...",
  "external_url": "https://wrapped.farcaster.xyz/42",
  "attributes": [
    {"trait_type": "Year", "value": 2025},
    {"trait_type": "FID", "value": 12345},
    {"trait_type": "Username", "value": "cryptoartist"},
    {"trait_type": "Casts", "value": 954, "display_type": "number"},
    {"trait_type": "Likes Received", "value": 12044, "display_type": "number"},
    {"trait_type": "Engagement Rate", "value": 24.8, "display_type": "number"},
    {"trait_type": "Consistency", "value": "11/12"},
    {"trait_type": "Unique Connections", "value": 287, "display_type": "number"},
    {"trait_type": "Rarity Tier", "value": "Legendary"},
    {"trait_type": "Rarity Score", "value": 92, "max_value": 100},
    {"trait_type": "Personality Type", "value": "Community Builder"}
  ]
}

SVG GENERATION (Minimalist Spotify Style):

function _generateSVG(
    uint256 tokenId,
    WrappedData memory data
) internal view returns (string memory) {
    string memory rarityColor = _getRarityColor(data.rarityTier);
    string memory username = _getUsername(tokenId, data);
    
    return string(abi.encodePacked(
        '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 600" style="background:#000">',
        
        // Gradient background
        '<defs>',
          '<linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%">',
            '<stop offset="0%" style="stop-color:', rarityColor, ';stop-opacity:0.8"/>',
            '<stop offset="100%" style="stop-color:#000;stop-opacity:1"/>',
          '</linearGradient>',
        '</defs>',
        
        '<rect width="400" height="600" fill="url(#g)"/>',
        
        // Header
        '<text x="40" y="60" fill="rgba(255,255,255,0.6)" font-size="12" font-weight="600" letter-spacing="2">FARCASTER</text>',
        '<text x="40" y="85" fill="#fff" font-size="32" font-weight="900">2025</text>',
        
        // Trophy Icon (simple circle)
        '<circle cx="350" cy="70" r="24" fill="', rarityColor, '" opacity="0.3"/>',
        '<text x="350" y="78" text-anchor="middle" font-size="20">ğŸ†</text>',
        
        // Username
        '<text x="40" y="150" fill="#fff" font-size="36" font-weight="900">@', username, '</text>',
        '<text x="40" y="175" fill="rgba(255,255,255,0.5)" font-size="12">FID ', Strings.toString(data.fid), '</text>',
        
        // Stats Grid
        _generateStatsGrid(data, rarityColor),
        
        // Rarity Badge
        '<rect x="40" y="470" width="320" height="80" rx="12" fill="', rarityColor, '" opacity="0.15"/>',
        '<text x="60" y="500" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="2">TIER</text>',
        '<text x="60" y="530" fill="', rarityColor, '" font-size="32" font-weight="900">', _getRarityName(data.rarityTier), '</text>',
        '<text x="340" y="500" text-anchor="end" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="2">SCORE</text>',
        '<text x="340" y="530" text-anchor="end" fill="#fff" font-size="32" font-weight="900">', _getRarityScore(data), '/100</text>',
        
        // Footer
        '<text x="200" y="580" text-anchor="middle" fill="rgba(255,255,255,0.3)" font-size="10">Edition #', Strings.toString(data.fid), ' â€¢ Minted 2025</text>',
        
        '</svg>'
    ));
}

function _generateStatsGrid(
    WrappedData memory data,
    string memory accentColor
) internal pure returns (string memory) {
    return string(abi.encodePacked(
        // Row 1
        '<rect x="40" y="210" width="150" height="70" rx="8" fill="rgba(255,255,255,0.05)"/>',
        '<text x="55" y="235" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="1">CASTS</text>',
        '<text x="55" y="265" fill="#fff" font-size="24" font-weight="900">', Strings.toString(data.casts), '</text>',
        
        '<rect x="210" y="210" width="150" height="70" rx="8" fill="rgba(255,255,255,0.05)"/>',
        '<text x="225" y="235" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="1">LIKES</text>',
        '<text x="225" y="265" fill="#fff" font-size="24" font-weight="900">', Strings.toString(data.likes), '</text>',
        
        // Row 2
        '<rect x="40" y="295" width="150" height="70" rx="8" fill="rgba(255,255,255,0.05)"/>',
        '<text x="55" y="320" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="1">ENGAGEMENT</text>',
        '<text x="55" y="350" fill="#fff" font-size="24" font-weight="900">', Strings.toString(data.engagementRate / 10), '.', Strings.toString(data.engagementRate % 10), '%</text>',
        
        '<rect x="210" y="295" width="150" height="70" rx="8" fill="rgba(255,255,255,0.05)"/>',
        '<text x="225" y="320" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="1">ACTIVE</text>',
        '<text x="225" y="350" fill="#fff" font-size="24" font-weight="900">', Strings.toString(data.consistency), '/12</text>',
        
        // Row 3
        '<rect x="40" y="380" width="150" height="70" rx="8" fill="rgba(255,255,255,0.05)"/>',
        '<text x="55" y="405" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="1">REPLIES</text>',
        '<text x="55" y="435" fill="#fff" font-size="24" font-weight="900">', Strings.toString(data.replies), '</text>',
        
        '<rect x="210" y="380" width="150" height="70" rx="8" fill="rgba(255,255,255,0.05)"/>',
        '<text x="225" y="405" fill="rgba(255,255,255,0.6)" font-size="10" font-weight="600" letter-spacing="1">CONNECTIONS</text>',
        '<text x="225" y="435" fill="#fff" font-size="24" font-weight="900">', Strings.toString(data.uniqueInteractors), '</text>'
    ));
}

DESIGN FEATURES:

âœ… Pure Typography - no images, no pixel art
âœ… Black Background (#000) - premium feel
âœ… Dynamic Gradients - based on rarity tier
âœ… Stats Grid - 6 key metrics in clean layout
âœ… Minimalist Icons - emoji/simple shapes only
âœ… Bold Numbers - stats are the hero
âœ… Subtle Backgrounds - translucent cards
âœ… Color Coding - tier colors for emphasis

SVG SIZE: ~2-3KB (vs 5-8KB with pixel art)
Gas Savings: ~10,000 additional gas saved


================================================================================
9ï¸âƒ£ ROYALTY SYSTEM (ERC2981)
================================================================================

(Same as original blueprint)

3% perpetual royalties to original minter
Automatically enforced on OpenSea, Blur, LooksRare


================================================================================
ğŸ”Ÿ MINTING RULES & ELIGIBILITY
================================================================================

CORE RULES:

Rule 1: ONE MINT PER FID (2025 only)
â”œâ”€ Each FID can mint exactly 1 Wrapped 2025 NFT
â”œâ”€ No multiple mints allowed
â””â”€ Check: require(!_hasMinted[fid])

Rule 2: FULL YEAR STATS
â”œâ”€ Stats calculated: Jan 1, 2025 â†’ Dec 31, 2025
â”œâ”€ OR: Account creation date â†’ mint date (if < 1 year)
â””â”€ Minimum 30 days of activity recommended

Rule 3: MINTING WINDOW
â”œâ”€ Opens: January 1, 2026 00:00 UTC
â”œâ”€ Closes: December 31, 2026 23:59 UTC
â””â”€ Miss the window? Wait for Wrapped 2026

Rule 4: MINT FEE
â”œâ”€ Must pay exactly 0.0005 ETH
â”œâ”€ Gas paid separately
â””â”€ Fee supports project operations

Rule 5: VERIFIED STATS
â”œâ”€ Stats signed by backend oracle
â”œâ”€ Signature valid for 10 minutes
â””â”€ Cannot fake or manipulate stats


================================================================================
1ï¸âƒ£1ï¸âƒ£ LEADERBOARD SYSTEM
================================================================================

CATEGORIES:

1. ğŸ† Top Overall Score (rarity score)
2. ğŸ“Š Most Casts
3. â¤ï¸ Most Likes Received
4. ğŸ’¬ Highest Engagement Rate
5. ğŸ”¥ Perfect Consistency (12/12)
6. ğŸ‘¥ Most Connections (unique interactors)
7. â­ Legendary Club (all Legendary tier holders)

REDIS OPERATIONS:

// Add to leaderboard
await redis.zadd('wrapped:2025:overall', rarityScore, `fid:${fid}`);

// Get top 100
const top100 = await redis.zrevrange('wrapped:2025:overall', 0, 99, 'WITHSCORES');

// Get user rank
const rank = await redis.zrevrank('wrapped:2025:overall', `fid:${fid}`);


================================================================================
1ï¸âƒ£2ï¸âƒ£ FRAME INTEGRATION (FARCASTER)
================================================================================

WRAPPED STORY FLOW (11 Slides):

Slide 1: INTRO
â”œâ”€ "Wrapped â€¢ Farcaster 2025"
â”œâ”€ Username display
â””â”€ Button: "Let's Go â†’"

Slide 2: TOP STATS
â”œâ”€ Large numbers: Casts, Likes, Engagement
â”œâ”€ Gradient backgrounds per stat
â””â”€ Button: "Next â†’"

Slide 3: IMPACT SCORE
â”œâ”€ "You made an impact!"
â”œâ”€ Large number: Activity Score (calculated)
â”œâ”€ Breakdown: Content created, engagements, reach
â””â”€ Button: "Keep Going â†’"

Slide 4: ENGAGEMENT
â”œâ”€ "Your content got X engagements"
â”œâ”€ Grid: Likes, Recasts, Replies
â””â”€ Button: "Show Me More â†’"

Slide 5: COMMUNITY
â”œâ”€ "You connected with X people"
â”œâ”€ Followers + Unique interactors
â””â”€ Button: "Continue â†’"

Slide 6: PATTERNS
â”œâ”€ "Your most active: Thursday, 9 PM"
â”œâ”€ Best day + peak hour
â””â”€ Button: "What Else? â†’"

Slide 7: CONSISTENCY
â”œâ”€ "You were active X/12 months"
â”œâ”€ Bar visualization
â””â”€ Button: "Almost There â†’"

Slide 8: PERSONALITY
â”œâ”€ "You are a Community Builder"
â”œâ”€ Traits list
â””â”€ Button: "Show My Tier â†’"

Slide 9: RARITY TIER
â”œâ”€ "LEGENDARY" (big reveal)
â”œâ”€ Score display (92/100)
â”œâ”€ Top X% message
â””â”€ Button: "Claim My NFT â†’"

Slide 10: ACHIEVEMENT
â”œâ”€ "Achievement Unlocked: Top 5% Creator"
â”œâ”€ Stats summary
â””â”€ Button: "Mint NFT â†’"

Slide 11: NFT PREVIEW
â”œâ”€ Show minimalist card design
â”œâ”€ Mint button (0.0005 ETH)
â”œâ”€ "Share to Farcaster"
â””â”€ Complete journey

FRAME METADATA (Frog Framework):

```typescript
import { Frog } from 'frog';
import { handle } from 'frog/vercel';

export const app = new Frog({
  title: 'Farcaster 2025 Wrapped',
  imageAspectRatio: '1:1',
});

app.frame('/', (c) => {
  return c.res({
    image: '/intro.png',
    intents: [
      <Button action="/stats">Get My Wrapped ğŸ‰</Button>,
    ],
  });
});

app.frame('/stats', async (c) => {
  const fid = c.frameData?.fid;
  const stats = await fetchWrappedStats(fid);
  
  return c.res({
    image: `/wrapped/${fid}/slide-3`,
    intents: [
      <Button action="/slide-4">Next â†’</Button>,
    ],
  });
});
```

SHARE TEXT TEMPLATE:

"I just got my Farcaster 2025 Wrapped! ğŸ‰

âœ¨ {TIER} Tier ({SCORE}/100)
ğŸ“Š {CASTS} casts â€¢ {LIKES} likes
ğŸ”¥ {CONSISTENCY}/12 months active
ğŸ‘¥ {CONNECTIONS} connections
ğŸ† {ACHIEVEMENT}

Get yours â†’ [frame-url]"


================================================================================
1ï¸âƒ£3ï¸âƒ£ ECONOMIC MODEL & SUSTAINABILITY
================================================================================

COST STRUCTURE (Updated):

Monthly Operating Costs:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Service               â”‚ Plan              â”‚ Cost/Month         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Backend Hosting       â”‚ Railway Pro       â”‚ $20                â”‚
â”‚ Redis Cache           â”‚ Upstash Pro       â”‚ $10                â”‚
â”‚ Neynar API            â”‚ Growth            â”‚ $50                â”‚
â”‚ Domain & CDN          â”‚ Vercel Pro        â”‚ $20                â”‚
â”‚ Frame Assets          â”‚ Cloudflare R2     â”‚ $5                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL                 â”‚                   â”‚ ~$105/month        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

REVENUE MODEL:

One-Time Minting Window (2025 Wrapped):
â”œâ”€ Minting period: Jan 1, 2026 â†’ Dec 31, 2026
â”œâ”€ Target: 10,000 mints
â”œâ”€ Revenue: 10,000 Ã— $1.50 = $15,000
â”œâ”€ Annual costs: $105 Ã— 12 = $1,260
â”œâ”€ Net profit: $13,740
â””â”€ Sustainability: Year 1 fully funds operations

Recurring Revenue (Secondary Sales):
â”œâ”€ No direct revenue (goes to original minters)
â”œâ”€ Benefits ecosystem through trading activity
â””â”€ Builds brand value for future years

YEARLY CADENCE:

2025 â†’ Wrapped 2025 (mints Jan-Dec 2026)
2026 â†’ Wrapped 2026 (mints Jan-Dec 2027)
2027 â†’ Wrapped 2027 (mints Jan-Dec 2028)
...

Each year is a separate NFT collection with its own stats and design evolution.


================================================================================
1ï¸âƒ£4ï¸âƒ£ DEPLOYMENT GUIDE
================================================================================

PHASE 1: SMART CONTRACT (November 2025)

1. Develop & Test Contract:
```bash
npx hardhat init
npm install @solady/src/tokens/ERC721.sol
```

2. Write Tests:
```javascript
describe("FarcasterWrapped2025", () => {
  it("Should mint with valid stats", async () => {
    const sig = await oracle.signMessage(hash);
    await wrapped.mint(fid, username, ...stats, sig, {value: MINT_FEE});
    expect(await wrapped.ownerOf(1)).to.equal(minter.address);
  });
  
  it("Should reject double mint", async () => {
    await wrapped.mint(...);
    await expect(wrapped.mint(...)).to.be.revertedWith("Already minted");
  });
  
  it("Should generate minimalist SVG", async () => {
    const uri = await wrapped.tokenURI(1);
    expect(uri).to.include("data:image/svg+xml");
    expect(uri).to.include("FARCASTER");
    expect(uri).to.include("2025");
  });
});
```

3. Deploy to Base:
```bash
npx hardhat run scripts/deploy.js --network base
npx hardhat verify --network base DEPLOYED_ADDRESS
```

Cost: ~$30-40

PHASE 2: BACKEND API (December 2025)

1. Setup Express API:
```javascript
// server.js
const express = require('express');
const { NeynarAPIClient } = require('@neynar/nodejs-sdk');

const app = express();
const neynar = new NeynarAPIClient(process.env.NEYNAR_API_KEY);

// Get wrapped stats for FID
app.get('/api/wrapped/:fid', async (req, res) => {
  const { fid } = req.params;
  
  // Fetch full year stats from Neynar
  const stats = await fetchWrappedStats(fid);
  
  // Calculate activity score (honest metric)
  const activityScore = calculateActivityScore(stats);
  
  // Calculate personality type
  const personality = calculatePersonality(stats);
  
  // Calculate rarity tier
  const rarityTier = calculateRarity(stats);
  
  // Generate signature
  const signature = await generateSignature(fid, stats);
  
  res.json({
    stats,
    activityScore,  // 0-100 scale
    personality,
    rarityTier,
    signature,
    wrappedData: {
      slides: generateSlideData(stats, activityScore)
    }
  });
});

// Activity Score Calculation
function calculateActivityScore(stats) {
  const score = 
    (stats.casts * 10) +
    (stats.replies * 15) +
    (stats.likes * 1) +
    (stats.recasts * 5) +
    (stats.followers * 2) +
    (stats.uniqueInteractors * 3);
  
  // Cap at 10,000 and convert to 0-100 scale
  const capped = Math.min(score, 10000);
  return Math.floor(capped / 100);
}

app.listen(3000);
```

2. Deploy to Railway:
```bash
railway init
railway up
```

Cost: $20/month

PHASE 3: WRAPPED FRAME (December 2025)

1. Create Frog Frame:
```typescript
// app/api/[[...routes]]/route.tsx
import { Frog, Button } from 'frog';

export const app = new Frog({
  title: 'Farcaster 2025 Wrapped',
  basePath: '/api',
});

// 11 frame routes for story
app.frame('/', ...);
app.frame('/slide-2', ...);
app.frame('/slide-3', ...);
// ... up to slide 11

export const GET = handle(app);
export const POST = handle(app);
```

2. Deploy to Vercel:
```bash
vercel --prod
```

Cost: $20/month

PHASE 4: LAUNCH (January 1, 2026)

Launch Timeline:
â”œâ”€ Dec 15, 2025: Soft launch (beta testers)
â”œâ”€ Dec 25, 2025: Marketing campaign begins
â”œâ”€ Jan 1, 2026: Public launch
â”œâ”€ Jan 7, 2026: First 1,000 mints milestone
â””â”€ Dec 31, 2026: Minting window closes

Marketing Strategy:
1. Partner with Farcaster influencers
2. Create demo Wrapped for popular accounts
3. Daily leaderboard updates
4. Personality type memes
5. Rarity tier badges in profiles


================================================================================
1ï¸âƒ£5ï¸âƒ£ TESTING STRATEGY
================================================================================

UNIT TESTS:

```javascript
describe("Wrapped SVG Generation", () => {
  it("Should generate black background", async () => {
    const svg = await wrapped.tokenURI(1);
    expect(svg).to.include('background:#000');
  });
  
  it("Should include username", async () => {
    const svg = await wrapped.tokenURI(1);
    expect(svg).to.include('@cryptoartist');
  });
  
  it("Should show rarity tier", async () => {
    const svg = await wrapped.tokenURI(1);
    expect(svg).to.include('LEGENDARY');
  });
  
  it("Should display stats grid", async () => {
    const svg = await wrapped.tokenURI(1);
    expect(svg).to.include('CASTS');
    expect(svg).to.include('LIKES');
    expect(svg).to.include('ENGAGEMENT');
  });
  
  it("Should use tier-specific gradient", async () => {
    const svg = await wrapped.tokenURI(1);
    expect(svg).to.include('#FFD700'); // Legendary gold
  });
});

describe("Activity Score Calculation", () => {
  it("Should calculate score for high activity user", () => {
    const stats = {
      casts: 800,
      replies: 400,
      likes: 2000,
      recasts: 500,
      followers: 150,
      uniqueInteractors: 250
    };
    // 8000 + 6000 + 2000 + 2500 + 300 + 750 = 19,550 â†’ 100 (capped)
    expect(calculateActivityScore(stats)).to.equal(100);
  });
  
  it("Should calculate score for moderate user", () => {
    const stats = {
      casts: 300,
      replies: 150,
      likes: 800,
      recasts: 200,
      followers: 50,
      uniqueInteractors: 100
    };
    // 3000 + 2250 + 800 + 1000 + 100 + 300 = 7,450 â†’ 74
    expect(calculateActivityScore(stats)).to.equal(74);
  });
  
  it("Should calculate score for casual user", () => {
    const stats = {
      casts: 50,
      replies: 30,
      likes: 200,
      recasts: 40,
      followers: 10,
      uniqueInteractors: 25
    };
    // 500 + 450 + 200 + 200 + 20 + 75 = 1,445 â†’ 14
    expect(calculateActivityScore(stats)).to.equal(14);
  });
  
  it("Should cap at 100", () => {
    const stats = {
      casts: 5000,  // Way over cap
      replies: 5000,
      likes: 10000,
      recasts: 5000,
      followers: 1000,
      uniqueInteractors: 1000
    };
    expect(calculateActivityScore(stats)).to.equal(100);
  });
});

describe("Personality Calculation", () => {
  it("Should identify Community Builder", () => {
    const stats = {
      casts: 800,
      replies: 450,
      uniqueInteractors: 280,
      consistency: 12
    };
    expect(calculatePersonality(stats)).to.equal("Community Builder");
  });
  
  it("Should identify Content Creator", () => {
    const stats = {
      casts: 1200,
      likes: 8000,
      avgLikesPerCast: 15,
      replies: 200
    };
    expect(calculatePersonality(stats)).to.equal("Content Creator");
  });
});
```

INTEGRATION TESTS:

```javascript
describe("End-to-End Minting", () => {
  it("Should complete full wrapped flow", async () => {
    // 1. Fetch stats from backend
    const response = await fetch(`/api/wrapped/${fid}`);
    const { stats, signature } = await response.json();
    
    // 2. Mint NFT
    const tx = await wrapped.mint(fid, username, ...stats, signature, {
      value: ethers.parseEther("0.0005")
    });
    await tx.wait();
    
    // 3. Verify NFT exists
    const owner = await wrapped.ownerOf(1);
    expect(owner).to.equal(minter.address);
    
    // 4. Check metadata
    const uri = await wrapped.tokenURI(1);
    expect(uri).to.include("Farcaster Wrapped 2025");
  });
});
```

VISUAL TESTS:

Create test SVG outputs for all 5 tiers:
```bash
node scripts/generateTestSVGs.js
# Output: test-common.svg, test-uncommon.svg, etc.
# Manually verify design quality
```


================================================================================
1ï¸âƒ£6ï¸âƒ£ EDGE CASES & ERROR HANDLING
================================================================================

EDGE CASES:

1. NEW USER (< 1 year on Farcaster)
   â””â”€ Use partial year stats
   â””â”€ Likely Common tier
   â””â”€ Still mintable

2. INACTIVE USER (0 casts in 2025)
   â””â”€ All stats = 0
   â””â”€ Common tier with 0 score
   â””â”€ Can still mint as "participation trophy"

3. DELETED/BANNED ACCOUNT
   â””â”€ Neynar returns 404
   â””â”€ Cannot mint
   â””â”€ Show error: "Account not found"

4. USERNAME CHANGE
   â””â”€ NFT shows username at mint time
   â””â”€ Creates collectible vintage value
   â””â”€ Not updated retroactively

5. EXTREME STATS (> uint16 max)
   â””â”€ Cap at 65,535
   â””â”€ Still gets max points for that metric
   â””â”€ Won't affect rarity calculation

6. SIGNATURE EXPIRY
   â””â”€ Valid for 10 minutes only
   â””â”€ User must refresh if expired
   â””â”€ Show error: "Stats expired, please refresh"

7. GAS PRICE SPIKE
   â””â”€ Show current gas estimate
   â””â”€ Warn if > $5 total
   â””â”€ Suggest waiting for lower gas

8. DUPLICATE MINT ATTEMPT
   â””â”€ Check _hasMinted[fid] on-chain
   â””â”€ Show: "You already minted your 2025 Wrapped!"
   â””â”€ Link to existing NFT

ERROR MESSAGES:

```javascript
const ERRORS = {
  ALREADY_MINTED: {
    title: "Already Wrapped!",
    message: "You already minted your 2025 Wrapped NFT.",
    action: "View Your NFT"
  },
  INVALID_SIGNATURE: {
    title: "Verification Failed",
    message: "Stats could not be verified. Please try again.",
    action: "Refresh Stats"
  },
  INSUFFICIENT_FUNDS: {
    title: "Insufficient Balance",
    message: "You need at least 0.0005 ETH + gas to mint.",
    action: "Add Funds"
  },
  ACCOUNT_NOT_FOUND: {
    title: "Account Not Found",
    message: "We couldn't find your Farcaster account.",
    action: "Contact Support"
  }
};
```


================================================================================
1ï¸âƒ£7ï¸âƒ£ ROADMAP & FUTURE FEATURES
================================================================================

PHASE 1: LAUNCH (Q1 2026) âœ…
âœ… Deploy smart contract
âœ… Launch Wrapped 2025 experience
âœ… 11-slide interactive story
âœ… Minimalist NFT design
âœ… Leaderboards
âœ… Share to Farcaster

PHASE 2: ENGAGEMENT (Q2 2026)
ğŸ”² Personality-based achievements
ğŸ”² Wrapped galleries (showcase all tiers)
ğŸ”² Comparison tool (compare with friends)
ğŸ”² Wrapped Hall of Fame (top 100)
ğŸ”² Community voting (favorite Wrapped)
ğŸ”² Physical prints (ship IRL cards)

PHASE 3: UTILITY (Q3 2026)
ğŸ”² Wrapped-gated channels
ğŸ”² Tier-based perks (Legendary = special access)
ğŸ”² Trading marketplace (P2P swaps)
ğŸ”² Wrapped staking (lock for benefits)
ğŸ”² Dynamic traits (update with achievements)
ğŸ”² Wrapped evolution (add 2026 stats)

PHASE 4: EXPANSION (Q4 2026)
ğŸ”² Wrapped 2026 planning
ğŸ”² Multi-year comparison tool
ğŸ”² Historical archives
ğŸ”² Developer API (build on Wrapped data)
ğŸ”² Mobile app (native experience)
ğŸ”² Other protocol integrations

YEARLY EVOLUTION:

2025 Wrapped (Minimalist Black):
â”œâ”€ Pure typography
â”œâ”€ Black background
â”œâ”€ Single-year stats
â””â”€ 5 tiers

2026 Wrapped (Dark Mode Plus):
â”œâ”€ Enhanced gradients
â”œâ”€ Year-over-year comparison
â”œâ”€ Growth percentages
â””â”€ 6 tiers (add Mythic)

2027 Wrapped (Premium):
â”œâ”€ Animated SVG elements
â”œâ”€ Multi-year timeline
â”œâ”€ Achievement badges
â””â”€ Dynamic rarity


================================================================================
1ï¸âƒ£8ï¸âƒ£ APPENDIX & RESOURCES
================================================================================

KEY LINKS:

Documentation:
â”œâ”€ Farcaster Docs: https://docs.farcaster.xyz
â”œâ”€ Neynar API: https://docs.neynar.com
â”œâ”€ Frog Framework: https://frog.fm
â”œâ”€ Base Chain: https://docs.base.org
â”œâ”€ Solady: https://github.com/Vectorized/solady
â””â”€ OpenSea: https://docs.opensea.io

Design Inspiration:
â”œâ”€ Spotify Wrapped: https://newsroom.spotify.com/wrapped
â”œâ”€ Dune Analytics: https://dune.com
â”œâ”€ GitHub Skyline: https://skyline.github.com
â””â”€ Year in Review trends

Tools:
â”œâ”€ SVG Preview: https://svgviewer.dev
â”œâ”€ Base Scanner: https://basescan.org
â”œâ”€ Frame Validator: https://warpcast.com/~/developers/frames
â””â”€ Gas Estimator: https://l2fees.info

ENVIRONMENT VARIABLES:

```bash
# Smart Contract
CONTRACT_ADDRESS=0x...
DEPLOYER_PRIVATE_KEY=0x...
STATS_ORACLE_PRIVATE_KEY=0x...

# Backend
NEYNAR_API_KEY=neynar_...
REDIS_URL=redis://...
PORT=3000

# Frontend
NEXT_PUBLIC_CONTRACT_ADDRESS=0x...
NEXT_PUBLIC_BASE_RPC=https://mainnet.base.org
NEXT_PUBLIC_BACKEND_URL=https://api.wrapped.xyz
```

TECH STACK SUMMARY:

Frontend: 
â”œâ”€ Frog (Farcaster Frames)
â”œâ”€ Next.js 14
â”œâ”€ Vercel Edge Functions
â””â”€ Tailwind CSS

Backend:
â”œâ”€ Node.js + Express
â”œâ”€ Neynar SDK
â”œâ”€ Redis (caching + leaderboards)
â”œâ”€ ethers.js (signature generation)
â””â”€ Railway (hosting)

Blockchain:
â”œâ”€ Base L2
â”œâ”€ Solidity 0.8.20
â”œâ”€ Solady (optimized ERC721)
â””â”€ Hardhat (development)

COST BREAKDOWN:

Development:
â”œâ”€ Smart Contract: $30 (one-time)
â”œâ”€ Testing: $20 (testnet gas)
â”œâ”€ Audit (optional): $5,000-10,000
â””â”€ Design: DIY (minimalist, no designer needed)

Monthly Operations:
â”œâ”€ Backend: $20 (Railway)
â”œâ”€ Cache: $10 (Upstash Redis)
â”œâ”€ API: $50 (Neynar)
â”œâ”€ Frontend: $20 (Vercel)
â”œâ”€ Assets: $5 (Cloudflare R2)
â””â”€ Total: ~$105/month

Revenue Projections:

Conservative (5,000 mints):
â”œâ”€ Revenue: $7,500
â”œâ”€ Annual costs: $1,260
â”œâ”€ Net: $6,240
â””â”€ ROI: 495%

Moderate (10,000 mints):
â”œâ”€ Revenue: $15,000
â”œâ”€ Annual costs: $1,260
â”œâ”€ Net: $13,740
â””â”€ ROI: 1,090%

Optimistic (20,000 mints):
â”œâ”€ Revenue: $30,000
â”œâ”€ Annual costs: $1,260
â”œâ”€ Net: $28,740
â””â”€ ROI: 2,281%

DEPLOYMENT TIMELINE:

November 2025:
â”œâ”€ Week 1-2: Smart contract development
â”œâ”€ Week 3: Backend API development
â””â”€ Week 4: Frame development

December 2025:
â”œâ”€ Week 1: Integration testing
â”œâ”€ Week 2: Security audit (optional)
â”œâ”€ Week 3: Beta testing (100 users)
â””â”€ Week 4: Marketing campaign launch

January 1, 2026:
â”œâ”€ ğŸš€ PUBLIC LAUNCH
â”œâ”€ Day 1: Monitor for issues
â”œâ”€ Week 1: First 1,000 mints
â””â”€ Month 1: Optimize based on feedback

Throughout 2026:
â”œâ”€ Monthly: Release leaderboard updates
â”œâ”€ Quarterly: Add new features
â””â”€ December 31: Close minting window


================================================================================
                              DESIGN SHOWCASE
================================================================================

MINIMALIST NFT CARD SPECS:

Dimensions: 400Ã—600px (SVG)
Background: #000000 (pure black)
Primary Text: #FFFFFF (pure white)
Secondary Text: rgba(255,255,255,0.6) (60% white)

Rarity Colors:
â”œâ”€ Legendary: #FFD700 (gold)
â”œâ”€ Epic: #9B59B6 (purple)
â”œâ”€ Rare: #3498DB (blue)
â”œâ”€ Uncommon: #2ECC71 (green)
â””â”€ Common: #95A5A6 (gray)

Typography:
â”œâ”€ Headers: 32-36px, weight 900
â”œâ”€ Stats: 24px, weight 900
â”œâ”€ Labels: 10-12px, weight 600, uppercase
â””â”€ Body: 12px, weight 400

Layout:
â”œâ”€ Padding: 40px all sides
â”œâ”€ Grid: 2 columns, 3 rows
â”œâ”€ Spacing: 15px gaps
â””â”€ Border radius: 8-12px on cards

Key Elements:
1. Header (Farcaster 2025)
2. Trophy icon (tier-colored)
3. Username (large, bold)
4. Stats grid (6 metrics)
5. Rarity badge (gradient background)
6. Edition number footer

SVG Optimization:
â”œâ”€ No external fonts (system fallbacks)
â”œâ”€ No images (pure SVG shapes)
â”œâ”€ Minimal gradients (1-2 per card)
â”œâ”€ Size: ~2-3KB (vs 8KB+ with images)
â””â”€ Fully on-chain compatible


================================================================================
                              SUCCESS METRICS
================================================================================

Year 1 Targets (2025 Wrapped):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Metric                    â”‚ Target        â”‚ Stretch Goal      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total Mints               â”‚ 10,000        â”‚ 20,000            â”‚
â”‚ Unique Minters            â”‚ 8,000         â”‚ 18,000            â”‚
â”‚ Revenue                   â”‚ $15,000       â”‚ $30,000           â”‚
â”‚ Secondary Volume          â”‚ $50,000       â”‚ $150,000          â”‚
â”‚ Avg Mint Time             â”‚ <3 days       â”‚ <24 hours         â”‚
â”‚ User Satisfaction         â”‚ 4.5/5         â”‚ 4.8/5             â”‚
â”‚ Frame Impressions         â”‚ 500,000       â”‚ 1,000,000         â”‚
â”‚ Social Shares             â”‚ 5,000         â”‚ 15,000            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Quality Metrics:
â”œâ”€ Gas cost: <$0.70 per mint
â”œâ”€ API response: <500ms
â”œâ”€ Frame load time: <2s
â”œâ”€ SVG render time: <100ms
â”œâ”€ Uptime: >99.9%
â”œâ”€ Error rate: <0.1%
â””â”€ Support tickets: <50/month


================================================================================
                              END OF BLUEPRINT
================================================================================

Version: 3.0 - Farcaster 2025 Wrapped Edition
Theme: Spotify Wrapped-Inspired Minimalist Design
Updated: November 30, 2025
Status: Ready for Implementation

ğŸ¨ DESIGN: Pure typography, no images, black background, dynamic gradients
ğŸ¯ TARGET: 10,000+ mints in 2026
ğŸ’° ECONOMICS: $15K revenue, $1.2K costs, 1,090% ROI
âš¡ TECHNICAL: 140k gas, fully on-chain SVG, Base L2
ğŸš€ TIMELINE: Launch January 1, 2026

Key Differentiators:
âœ… Spotify Wrapped aesthetic (vs trading card style)
âœ… Pure CSS/SVG design (vs pixel art)
âœ… Personality types (vs just stats)
âœ… 11-slide story experience (vs static view)
âœ… Year-specific collection (vs ongoing series)
âœ… Minimalist premium feel (vs busy graphics)

This blueprint is ready for a developer to implement a production-ready
Farcaster 2025 Wrapped NFT experience that celebrates users' social journey
in a beautiful, minimalist, and fully on-chain format.

Repository: github.com/yourproject/farcaster-wrapped-2025

Let's make 2025 unforgettable! ğŸ‰

================================================================================